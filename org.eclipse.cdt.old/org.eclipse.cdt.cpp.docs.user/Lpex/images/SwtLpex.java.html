<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html><head><title>SwtLpex.java</title></head><body><pre>
<font color="#008080">//----------------------------------------------------------------------------</font>
<font color="#008080">// COMPONENT_NAME: LPEX Editor</font>
<font color="#008080">//</font>
<font color="#008080">// IBM(R) VA BASE</font>
<font color="#008080">// (C) Copyright IBM Corp. 2000</font>
<font color="#008080">// The source code for this program is not published or otherwise divested</font>
<font color="#008080">// of its trade secrets, irrespective of what has been deposited with the</font>
<font color="#008080">// U.S. Copyright Office.</font>
<font color="#008080">//</font>
<font color="#008080">// DESCRIPTION:</font>
<font color="#008080">// SwtLpex - sample/test class for SWT JavaLPEX.</font>
<font color="#008080">//----------------------------------------------------------------------------</font>

<font color="#0000ff">import</font><font color="#000000"> com.ibm.swt.SWT;</font>
<font color="#0000ff">import</font><font color="#000000"> com.ibm.swt.graphics.Rectangle;</font>
<font color="#0000ff">import</font><font color="#000000"> com.ibm.swt.widgets.Display;</font>
<font color="#0000ff">import</font><font color="#000000"> com.ibm.swt.widgets.Event;</font>
<font color="#0000ff">import</font><font color="#000000"> com.ibm.swt.widgets.Listener;</font>
<font color="#0000ff">import</font><font color="#000000"> com.ibm.swt.widgets.MessageBox;</font>
<font color="#0000ff">import</font><font color="#000000"> com.ibm.swt.widgets.Shell;</font>

<font color="#0000ff">import</font><font color="#000000"> com.ibm.lpex.core.LpexView;</font>
<font color="#0000ff">import</font><font color="#000000"> com.ibm.lpex.core.LpexWindow;</font>

<font color="#008080">/*</font>
<font color="#008080"> * This class is used to test the SWT JavaLPEX editor widget by providing</font>
<font color="#008080"> * a sample standalone editor.</font>
<font color="#008080"> */</font>
<font color="#0000ff">public</font><font color="#000000"> </font><font color="#0000ff">final</font><font color="#000000"> </font><font color="#0000ff">class</font><font color="#000000"> SwtLpex</font>
<font color="#000000">{</font>
<font color="#000000">   Shell      _shell;</font>
<font color="#000000">   String     _filename;</font>
<font color="#000000">   LpexView   _lpexView;</font>
<font color="#000000">   LpexWindow _lpexWindow;</font>

<font color="#000000">   </font><font color="#0000ff">public</font><font color="#000000"> </font><font color="#0000ff">static</font><font color="#000000"> </font><font color="#0000ff">void</font><font color="#000000"> main(String[] args)</font>
<font color="#000000">   {</font>
<font color="#000000">      String filename = </font><font color="#0000ff">null</font><font color="#000000">;</font>
<font color="#000000">      </font><font color="#0000ff">if</font><font color="#000000"> (args.length > </font><font color="#800000">0</font><font color="#000000">)</font>
<font color="#000000">         filename = args[</font><font color="#800000">0</font><font color="#000000">];</font>
<font color="#000000">      </font><font color="#0000ff">new</font><font color="#000000"> SwtLpex(filename).open().run().close();</font>
<font color="#000000">   }</font>

<font color="#000000">   SwtLpex(String filename)</font>
<font color="#000000">   {</font>
<font color="#000000">      _filename = filename;</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#0000ff">public</font><font color="#000000"> SwtLpex open()</font>
<font color="#000000">   {</font>
<font color="#000000">      </font><font color="#008080">// create a new Shell</font>
<font color="#000000">      _shell = </font><font color="#0000ff">new</font><font color="#000000"> Shell();</font>

<font color="#000000">      </font><font color="#008080">// create an LpexView for the file name passed in</font>
<font color="#000000">      _lpexView = </font><font color="#0000ff">new</font><font color="#000000"> LpexView(_filename);</font>

<font color="#000000">      </font><font color="#008080">// set Shell title</font>
<font color="#000000">      String name = _lpexView.query(</font><font color="#800080">"name"</font><font color="#000000">);</font>
<font color="#000000">      </font><font color="#0000ff">if</font><font color="#000000"> (name == </font><font color="#0000ff">null</font><font color="#000000">)</font>
<font color="#000000">         name = </font><font color="#800080">"Untitled Document "</font><font color="#000000"> + _lpexView.query(</font><font color="#800080">"documentId"</font><font color="#000000">);</font>
<font color="#000000">      _shell.setText(</font><font color="#800080">"SWT JavaLPEX - "</font><font color="#000000"> + name);</font>

<font color="#000000">      </font><font color="#008080">// add our own LPEX actions</font>
<font color="#000000">      updateProfile(_lpexView);</font>

<font color="#000000">      </font><font color="#008080">// create &amp; set a window for our LpexView</font>
<font color="#000000">      _lpexWindow = </font><font color="#0000ff">new</font><font color="#000000"> LpexWindow(_shell);</font>
<font color="#000000">      _lpexView.setWindow(_lpexWindow);</font>

<font color="#000000">      </font><font color="#008080">// display the document</font>
<font color="#000000">      LpexView.doGlobalCommand(</font><font color="#800080">"screenShow"</font><font color="#000000">);</font>

<font color="#000000">      </font><font color="#008080">// listen to a few Shell events</font>
<font color="#000000">      _shell.addListener(SWT.Close, </font><font color="#0000ff">new</font><font color="#000000"> Listener() {</font>
<font color="#000000">         </font><font color="#0000ff">public</font><font color="#000000"> </font><font color="#0000ff">void</font><font color="#000000"> handleEvent(Event event) { closeShell(event); }}</font>
<font color="#000000">         );</font>
<font color="#000000">      _shell.addListener(SWT.Resize, </font><font color="#0000ff">new</font><font color="#000000"> Listener() {</font>
<font color="#000000">         </font><font color="#0000ff">public</font><font color="#000000"> </font><font color="#0000ff">void</font><font color="#000000"> handleEvent(Event event) { resizeShell(event); }}</font>
<font color="#000000">         );</font>
<font color="#000000">      _shell.addListener(SWT.Iconify, </font><font color="#0000ff">new</font><font color="#000000"> Listener() {</font>
<font color="#000000">         </font><font color="#0000ff">public</font><font color="#000000"> </font><font color="#0000ff">void</font><font color="#000000"> handleEvent(Event event) { iconifyShell(event); }}</font>
<font color="#000000">         );</font>
<font color="#000000">      _shell.addListener(SWT.Deiconify, </font><font color="#0000ff">new</font><font color="#000000"> Listener() {</font>
<font color="#000000">         </font><font color="#0000ff">public</font><font color="#000000"> </font><font color="#0000ff">void</font><font color="#000000"> handleEvent(Event event) { deiconifyShell(event); }}</font>
<font color="#000000">         );</font>
<font color="#000000">      _shell.addListener(SWT.Activate, </font><font color="#0000ff">new</font><font color="#000000"> Listener() {</font>
<font color="#000000">         </font><font color="#0000ff">public</font><font color="#000000"> </font><font color="#0000ff">void</font><font color="#000000"> handleEvent(Event event) { activateShell(event); }}</font>
<font color="#000000">         );</font>
<font color="#000000">      _shell.addListener(SWT.Deactivate, </font><font color="#0000ff">new</font><font color="#000000"> Listener() {</font>
<font color="#000000">         </font><font color="#0000ff">public</font><font color="#000000"> </font><font color="#0000ff">void</font><font color="#000000"> handleEvent(Event event) { deactivateShell(event); }}</font>
<font color="#000000">         );</font>

<font color="#000000">      </font><font color="#008080">// set Shell's position &amp; size, open it</font>
<font color="#000000">      _shell.setBounds(</font><font color="#800000">0</font><font color="#000000">, </font><font color="#800000">0</font><font color="#000000">, </font><font color="#800000">648</font><font color="#000000">, </font><font color="#800000">711</font><font color="#000000">);</font>
<font color="#000000">      _shell.open();</font>

<font color="#000000">      </font><font color="#008080">// set input focus in the edit area</font>
<font color="#000000">      _lpexWindow.textWindow().setFocus();</font>

<font color="#000000">      </font><font color="#0000ff">return</font><font color="#000000"> </font><font color="#0000ff">this</font><font color="#000000">;</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#008080">/**</font>
<font color="#008080">    * Define any desired new LPEX commands, actions, and keys.</font>
<font color="#008080">    */</font>
<font color="#000000">   </font><font color="#0000ff">void</font><font color="#000000"> updateProfile(LpexView lpexView)</font>
<font color="#000000">   {</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#0000ff">public</font><font color="#000000"> SwtLpex close()</font>
<font color="#000000">   {</font>
<font color="#000000">      </font><font color="#0000ff">if</font><font color="#000000"> ((_shell != </font><font color="#0000ff">null</font><font color="#000000">) &amp;&amp; !_shell.isDisposed())</font>
<font color="#000000">         _shell.dispose();</font>
<font color="#000000">      _shell = </font><font color="#0000ff">null</font><font color="#000000">;</font>
<font color="#000000">      </font><font color="#0000ff">return</font><font color="#000000"> </font><font color="#0000ff">this</font><font color="#000000">;</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#0000ff">void</font><font color="#000000"> closeShell(Event event)</font>
<font color="#000000">   {</font>
<font color="#000000">      Rectangle rect = _shell.getClientArea();</font>
<font color="#000000">      MessageBox box = </font><font color="#0000ff">new</font><font color="#000000"> MessageBox(_shell, SWT.ICON_QUESTION | SWT.YES | SWT.NO);</font>
<font color="#000000">      box.setText(_shell.getText());</font>
<font color="#000000">      box.setMessage (</font><font color="#800080">"Close the SWT JavaLPEX Example shell?"</font><font color="#000000">);</font>
<font color="#000000">      event.doit = box.open() == SWT.YES;</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#0000ff">void</font><font color="#000000"> activateShell(Event event)</font>
<font color="#000000">   {</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#0000ff">void</font><font color="#000000"> deactivateShell(Event event)</font>
<font color="#000000">   {</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#0000ff">void</font><font color="#000000"> deiconifyShell(Event event)</font>
<font color="#000000">   {</font>
<font color="#000000">      </font><font color="#008080">// remove the leading '*' added when iconified</font>
<font color="#000000">      _shell.setText(_shell.getText().substring(</font><font color="#800000">1</font><font color="#000000">));</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#0000ff">void</font><font color="#000000"> iconifyShell(Event event)</font>
<font color="#000000">   {</font>
<font color="#000000">      </font><font color="#008080">// add a leading '*' for the taskbar icon name</font>
<font color="#000000">      _shell.setText(</font><font color="#800080">"*"</font><font color="#000000"> + _shell.getText());</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#008080">/**</font>
<font color="#008080">    * Shell size was set / Shell was resized.</font>
<font color="#008080">    */</font>
<font color="#000000">   </font><font color="#0000ff">void</font><font color="#000000"> resizeShell(Event event)</font>
<font color="#000000">   {</font>
<font color="#000000">      Rectangle rect = _shell.getClientArea();</font>
<font color="#000000">      _lpexWindow.setBounds(</font><font color="#800000">0</font><font color="#000000">, </font><font color="#800000">0</font><font color="#000000">, rect.width, rect.height);</font>
<font color="#000000">   }</font>

<font color="#000000">   </font><font color="#0000ff">public</font><font color="#000000"> SwtLpex run()</font>
<font color="#000000">   {</font>
<font color="#000000">      Display display = _shell.getDisplay();</font>
<font color="#000000">      </font><font color="#0000ff">while</font><font color="#000000"> (!_shell.isDisposed()) {</font>
<font color="#000000">         </font><font color="#0000ff">if</font><font color="#000000"> (!display.readAndDispatch())</font>
<font color="#000000">            display.sleep();</font>
<font color="#000000">         }</font>
<font color="#000000">      </font><font color="#0000ff">return</font><font color="#000000"> </font><font color="#0000ff">this</font><font color="#000000">;</font>
<font color="#000000">   }</font>
<font color="#000000">}</font>
</pre></body></html>